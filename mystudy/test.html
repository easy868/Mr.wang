<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <meta content="telephone=no,email=no" name="format-detection">
    <title>js瀑布流</title>
    <link rel="stylesheet" href="css/bootstrap.css">
    <style>
        .list { position: relative; margin: auto; background: #f0f0f0; text-align: center; color: #666; }
        .list .item { position: absolute; padding: 10px; }
        .list .pic { padding: 10px 10px 0 10px; box-shadow: 2px 2px 2px rgba(0, 0, 0, .5); background: #f9f9f9; }
        .list .pic img { display: block; }
    </style>
</head>
<body>
<section class="list">
    <div class="item">
        <div class="pic">
            <img src="images/p3.jpg" alt="">7
        </div>
    </div>
    <div class="item">
        <div class="pic">
            <img src="images/p4.jpg" alt="">1
        </div>
    </div>
    <div class="item">
        <div class="pic">
            <img src="images/p6.jpg" alt="">2
        </div>
    </div>
    <div class="item">
        <div class="pic">
            <img src="images/p8.jpg" alt="">3
        </div>
    </div>
    <div class="item">
        <div class="pic">
            <img src="images/p11.jpg" alt="">4
        </div>
    </div>
    <div class="item">
        <div class="pic">
            <img src="images/p1.jpg" alt="">5
        </div>
    </div>
    <div class="item">
        <div class="pic">
            <img src="images/p3.jpg" alt="">7
        </div>
    </div>
    <div class="item">
        <div class="pic">
            <img src="images/p5.jpg" alt="">1
        </div>
    </div>
    <div class="item">
        <div class="pic">
            <img src="images/p17.jpg" alt="">2
        </div>
    </div>
    <div class="item">
        <div class="pic">
            <img src="images/p9.jpg" alt="">3
        </div>
    </div>
    <div class="item">
        <div class="pic">
            <img src="images/p2.jpg" alt="">4
        </div>
    </div>
    <div class="item">
        <div class="pic">
            <img src="images/p20.jpg" alt="">5
        </div>
    </div>
    <div class="item">
        <div class="pic">
            <img src="images/p16.jpg" alt="">7
        </div>
    </div>
    <div class="item">
        <div class="pic">
            <img src="images/p8.jpg" alt="">1
        </div>
    </div>
    <div class="item">
        <div class="pic">
            <img src="images/p18.jpg" alt="">2
        </div>
    </div>
    <div class="item">
        <div class="pic">
            <img src="images/p3.jpg" alt="">3
        </div>
    </div>
    <div class="item">
        <div class="pic">
            <img src="images/p13.jpg" alt="">4
        </div>
    </div>
    <div class="item">
        <div class="pic">
            <img src="images/p5.jpg" alt="">5
        </div>
    </div>
    <div class="item">
        <div class="pic">
            <img src="images/p3.jpg" alt="">3
        </div>
    </div>
    <div class="item">
        <div class="pic">
            <img src="images/p13.jpg" alt="">4
        </div>
    </div>
    <div class="item">
        <div class="pic">
            <img src="images/p5.jpg" alt="">5
        </div>
    </div>
    <div class="item">
        <div class="pic">
            <img src="images/p15.jpg" alt="">5
        </div>
    </div>
    <div class="item">
        <div class="pic">
            <img src="images/p7.jpg" alt="">7
        </div>
    </div>
</section>

<!--HTML区域-->
<script>
    waterFall('list', 'item');
    function waterFall(father, child) {
        var list = document.getElementsByClassName(father)[0],
            item = list.getElementsByClassName(child),
            oneWidth = item[0].offsetWidth,
            allHeight = [],
            col = Math.floor(document.documentElement.clientWidth / oneWidth);
        list.style.width = oneWidth * col + 'px';
        for (var i = 0; i < item.length; i++) {
            if (i < col) {
                item[i].style.top = 0;
                item[i].style.left = oneWidth * i + 'px';
                allHeight[i] = item[i].offsetHeight;
            } else {
                var minHeight = Math.min.apply(null, allHeight),
                    minIdx = allHeight.indexOf(minHeight);
                item[i].style.top = minHeight + 'px';
                item[i].style.left = oneWidth * minIdx + 'px';
                allHeight[minIdx] += item[i].offsetHeight;
            }
        }
        var maxH = Math.max.apply(null, allHeight);
        list.style.height = maxH + 'px';
    }
    function scrollFn() {
        var viewH = document.documentElement.clientHeight || window.pageYOffset || document.body.clientHeight,
            scrollTop = document.body.scrollTop || document.documentElement.scrollTop,
            scrollH = document.body.scrollHeight || document.documentElement.scrollHeight;
        return (scrollH - (scrollTop + viewH) < 50) ? true : false
    }

</script>
</body>
</html>